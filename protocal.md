# protocal

## 1.什么是GWAS

这玩意就是：找出基因中哪些序列变异（SNP），与疾病相关！

核心就是关联！

### 如何关联

基因（改变）与表型（phenotype，总之就是各种各样的看得到的现象）有没有关系！

> 对多个个体在全基因组范围的遗传变异多态性进行检测，获得基因型，进而将基因型与可观测的性状，即表型，进行群体水平的统计学分析，根据统计量或P值筛选出最有可能影响该性状的遗传变异。

### 分析方法

#### 逻辑回归（表型数据为二元）

用于数据为二元的：如0（没病）和1（有病）；

#### 线性回归（表型数据为连续性变量）

线性回归用于数据为连续性的；如林志玲身高173cm，任賢齊174cm，李治廷175cm，黄晓明176cm等

#### 表型数据正态分析（如果不是正态分布，需转换处理为正态分布）

一般是钟型的正态分布的，很多统计方法都是根据正态分布作出的分析。

## 2.五大格式

plink主要处理五大格式文件：

第一组：ped map

第二组：bed fam bim

### ped格式

ped必须和fam在一起

| Family ID | Individual ID | Paternal ID | Maternal ID | Sex  | Phenotype | Genotypes |
| --------- | ------------- | ----------- | ----------- | ---- | --------- | --------- |
| 家族ID    | 个人ID        | 父亲ID      | 母亲ID      | 性别 | 表型      | 基因型    |
| FAM001    | 1             | 0 0         | 1 2         | A A  | G G       | A C       |
| HCB181    | 1             | 0 0         | 1 1         | 2 2  | 2 2       | 2 2       |

### map格式

共4行

| chr    | snp identifier | morgans  | bp units |
| ------ | -------------- | -------- | -------- |
| 染色体 | snp标识        | 基因距离 | 碱基距离 |
| 1      | rs0            | 0        | 1000     |
| 1      | rs10           | 0        | 1001     |

装着检测出来的SNP信息

### 各个格式关系

生成bed、fam、bim、文件

  1.由于Plink程序识别的是二进制文件，所以我们要通过相应的命令将其转化成二进制的。

  2.为什么要转换成二进制？

  子曰：天下武功，唯快不破！（加快计算机运算）

  3.利用**--make-bed**产生可以用于分析的二进制数据（就是下面的东东了），一件生成的（一次过满足你三个愿望！）

### bed文件

1.首先这里强调的是bed文件与UCSC Genome Browser's BED format 是完全不一样的。

2.bed 文件与bim fam 文件一起的 (这三个是一起的)

3.bed文件是一个**二进制**文件，所以**你是看不来的**

### bim文件

1.从这个说明我们可以看出bim文件是对map文件的拓展

2.总共有六行，包含了snp（variants）的具体信息

2.1.第一列是染色体信息

2.2.第二列是snp的名字

2.3.第三列是摩尔距离，文件中说可以用0，没关系

2.4.第四列是物理距离

2.5.第五列是次要等位基因

2.6.第六列是主要等位基因

这里的信息要和bed文件对应起来

3.这个文件也是要和bed fam 文件结合来使用(这三个是一起的)

| 染色体信息 | snp的名字 | 摩尔距离 | 物理距离 | 次要等位基因 | 主要等位基因 |
| ---------- | --------- | -------- | -------- | ------------ | ------------ |
| 1          | res0      | 0        | 1000     | 0            | c            |
| 1          | res10     | 0        | 1001     | G            | A            |

### fam格式

1.fam文件记录了每个样本家系的信息

2.fam文件也是必须和bed bim文件一起使用

3.主要有6 列：

3.1.第一列是Family ID ('FID')

3.2.第二列是Within-family ID ('IID'; cannot be '0')

3.3.第三列是Within-family ID of father ('0' if father isn't in dataset)

3.4.第四列是Within-family ID of mother ('0' if mother isn't in dataset)

3.5.第五列是性别 ('1' = male, '2' = female, '0' = unknown)

3.6.第六列是表型 ('1' = control, '2' = case, '-9'/'0'/non-numeric = missing data if case/control)

| FID  | IID        | ID of father | ID of mother | 性别 | 表型 |
| ---- | ---------- | ------------ | ------------ | ---- | ---- |
| 1    | 1000000000 | 0            | 0            | 1    | 1    |
| 1    | 1000000001 | 0            | 0            | 1    | 2    |

fam就是代表family嘛！ 有家系信息的。

bim可以看成是**bi**nary（二进制）+**m**ap（地图）加在一起的！这里的信息要和bed文件对应起来